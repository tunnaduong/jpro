<div id="logout" class="modal">
  <div class="modal-content">
    <div class="modal-header">
      <span class="closeLogout">&times;</span>
      <h3>Logout</h3>
    </div>
    <div class="modal-body">
      <div class="modal-container">
        Chọn "Đăng xuất" bên dưới nếu bạn đã sẵn sàng kết thúc phiên hiện tại
        của mình.
      </div>
    </div>
    <div class="modal-footer">
      <button
        type="submit"
        onclick="location.href = '/logout'"
        class="cover-box"
      >
        Đăng xuất
      </button>
    </div>
  </div>
</div>
<div id="navbarmenu" class="menu-bar" style="display: none">
  <div class="left-side-menu display-row">
    <img
      src="/static/images/js_logo.png"
      class="menu-logo"
      alt="JPro Logo"
      width="60"
    />
    <div class="search">
      <div class="search-icon">
        <i class="fas fa-search"></i>
      </div>
      <div class="search-field">
        <input type="text" class="search-input" placeholder="Tìm kiếm..." />
      </div>
    </div>
  </div>

  <div class="right-side-menu">
    <div class="chat-button no-select">
      <ion-icon name="chatbubble"></ion-icon>
      <ion-icon name="flash"></ion-icon>
      <div class="nav-btn-badge">3</div>
    </div>
    <div class="notification-button no-select">
      <ion-icon name="notifications"></ion-icon>
      <div class="nav-btn-badge">9</div>
      <div class="dropdown-content" id="noti-dropdown">
        <h4>Thông báo</h4>
        <div class="empty-notification">Không có thông báo nào...</div>
      </div>
    </div>
    <div class="user-button dropdown">
      <img
        src="/static/images/pbhuu.jpeg"
        alt="Ảnh đại diện..."
        width="40"
        height="40"
      />
      <div class="menu-user-info">Bằng Hữu</div>
      <div class="dropdown-content" id="user-dropdown">
        <button class="dropdown-item" onclick="location.href = '/profile'">
          <ion-icon name="person-circle-outline"></ion-icon> Trang cá nhân
        </button>
        <button class="dropdown-item logout-red" id="logoutBtn">
          <ion-icon name="log-out-outline"></ion-icon> Đăng xuất
        </button>
      </div>
    </div>
  </div>
  <div id="sidebar">
    <div
      id="home-btn"
      class="menu-nav-button"
      onclick="window.location.href='/'"
    >
      <ion-icon id="home-icon" name="planet-outline"></ion-icon>
      <div class="nav-btn-text">Trang chủ</div>
    </div>
    <div
      id="about-btn"
      class="menu-nav-button"
      onclick="window.location.href='/about'"
    >
      <ion-icon id="about-icon" name="information-circle-outline"></ion-icon>
      <div class="nav-btn-text">Giới thiệu</div>
    </div>
    <div
      id="discuss-btn"
      class="menu-nav-button"
      onclick="window.location.href='/discussions'"
    >
      <ion-icon id="discuss-icon" name="chatbox-ellipses-outline"></ion-icon>
      <div class="nav-btn-text">Thảo luận</div>
    </div>
    <div
      id="learn-btn"
      class="menu-nav-button"
      onclick="window.location.href='/learn'"
    >
      <ion-icon id="learn-icon" name="book-outline"></ion-icon>
      <div class="nav-btn-text">Học tập</div>
    </div>
    <div
      id="techtalk-btn"
      class="menu-nav-button"
      onclick="window.location.href='/techtalk'"
    >
      <ion-icon id="techtalk-icon" name="cafe-outline"></ion-icon>
      <div class="nav-btn-text">TechTalk</div>
    </div>
  </div>
  <div class="menu-navigation-buttons">
    <button id="sidebarCollapse"><i class="fas fa-align-justify"></i></button>
    <div
      id="home-btn-desktop"
      class="menu-nav-button"
      onclick="window.location.href='/'"
    >
      <ion-icon id="home-icon-desktop" name="planet-outline"></ion-icon>
      <div class="nav-btn-text">Trang chủ</div>
    </div>
    <div
      id="about-btn-desktop"
      class="menu-nav-button"
      onclick="window.location.href='/about'"
    >
      <ion-icon
        id="about-icon-desktop"
        name="information-circle-outline"
      ></ion-icon>
      <div class="nav-btn-text">Giới thiệu</div>
    </div>
    <div
      id="discuss-btn-desktop"
      class="menu-nav-button"
      onclick="window.location.href='/discussions'"
    >
      <ion-icon
        id="discuss-icon-desktop"
        name="chatbox-ellipses-outline"
      ></ion-icon>
      <div class="nav-btn-text">Thảo luận</div>
    </div>
    <div
      id="learn-btn-desktop"
      class="menu-nav-button"
      onclick="window.location.href='/learn'"
    >
      <ion-icon id="learn-icon-desktop" name="book-outline"></ion-icon>
      <div class="nav-btn-text">Học tập</div>
    </div>
    <div
      id="techtalk-btn-desktop"
      class="menu-nav-button"
      onclick="window.location.href='/techtalk'"
    >
      <ion-icon id="techtalk-icon-desktop" name="cafe-outline"></ion-icon>
      <div class="nav-btn-text">TechTalk</div>
    </div>
  </div>
</div>
<script>
  $(document).mouseup(function (e) {
    var container = $(".user-button");
    // if the target of the click isn't the container nor a descendant of the container
    if (!container.is(e.target) && container.has(e.target).length === 0) {
      $("#user-dropdown").removeClass("display");
    }
  });

  $(".user-button").on("click", () => {
    $("#user-dropdown").toggleClass("display");
  });

  $(document).mouseup(function (e) {
    var container = $(".notification-button");
    // if the target of the click isn't the container nor a descendant of the container
    if (!container.is(e.target) && container.has(e.target).length === 0) {
      $("#noti-dropdown").removeClass("display");
    }
  });

  $(".notification-button").on("click", () => {
    $("#noti-dropdown").toggleClass("display");
  });

  if (location.pathname === "/") {
    $("#home-btn").addClass("nav-btn-active");
    $("#home-icon").attr("name", "planet");
  }
  $(document).ready(function () {
    $("#sidebarCollapse").on("click", function () {
      $("#sidebar").toggleClass("active");
    });
  });
  var logoutModal = document.getElementById("logout");
  var logoutbtn = document.getElementById("logoutBtn");
  var logoutSpan = document.getElementsByClassName("closeLogout")[0];
  logoutbtn.onclick = function () {
    logoutModal.style.display = "block";
  };
  logoutSpan.onclick = function () {
    logoutModal.style.display = "none";
  };
  window.onclick = function (event) {
    if (event.target == modal) {
      logoutModal.style.display = "none";
    }
  };
</script>
<script>
  $(document).ready(function () {
    console.log("if else");
    if (localStorage.getItem("access_token") != null) {
      $("#navbarmenu").css("display", "block");
    } else {
      $("#include-content").css("margin", "0");
    }
  });
</script>
